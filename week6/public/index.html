<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>首頁</title>
        <link rel="stylesheet" type="text/css" href="/static/style.css" />
    </head>
    <body>
        <div class="title">    
            <div class="titleword">歡迎光臨，請註冊登入系統</div>
        </div>
        <div class="system">
            <div class="systemtitle">註冊帳號</div>
            <label>姓名
                <input type="text" id="signup-name"/>
            </label>
            <label>信箱
                <input type="text" id="signup-email"/>
            </label>
            <label>密碼
                <input type="text" id="signup-password"/>
            </label>
            <button class="button" onclick="signup()">註冊</button>
        </div>
        <div class="system">
            <div class="systemtitle">登入系統</div>
            <label>信箱
                <input type="text" id="signin-email"/>
            </label>
            <label>密碼
                <input type="text" id="signin-password"/>
            </label>
            <button class="button" onclick="signin()">登入</button>
        </div>
        <script>
            async function signup(){
                let name=document.querySelector("#signup-name").value;
                let email=document.querySelector("#signup-email").value;
                let password=document.querySelector("#signup-password").value;
                if(name=="" || email=="" || password==""){
                    alert("請填入完整註冊內容")
                    return;
                }
                let response=await fetch("/signup",{
                    method:"POST",
                    body:JSON.stringify({"name":name, "email":email, "password":password})
                });
                let result=await response.json();
                if(result.ok){
                    alert("註冊成功")
                }else{
                    window.location="/ohoh?msg=重複的電⼦郵件"
                }
            }
            async function signin(){
                let email=document.querySelector("#signin-email").value;
                let password=document.querySelector("#signin-password").value;
                if(email=="" || password==""){
                    alert("請輸入帳號密碼")
                    return;
                }
                let response=await fetch("/login",{
                    method:"POST",
                    body:JSON.stringify({"email":email, "password":password})
                });
                let result=await response.json();
                if(result.ok){
                    window.location="/member";
                }else if(result.email){
                    window.location="/ohoh?msg=帳號輸入錯誤";
                }else if(result.password){
                    window.location="/ohoh?msg=密碼輸入錯誤";
                }
            }
            
        </script>
    </body>
</html>